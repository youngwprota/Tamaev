<!DOCTYPE html>
<!-- saved from url=(0021)https://acade.studio/ -->
<html><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/content/location/location.js" id="eppiocemhmnlbhjplcgkofciiegomcon"></script><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/libs/extend-native-history-api.js"></script><script src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/libs/requests.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src &#39;unsafe-eval&#39; &#39;self&#39; https://cdn.jsdelivr.net/npm/near-api-js@0.41.0/dist/near-api-js.js https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/ https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/ https://rpc.acade.studio; style-src &#39;self&#39; &#39;unsafe-inline&#39; https://cdn.jsdelivr.net/ https://cdnjs.cloudflare.com/; img-src &#39;self&#39; data:">
    <title>Acadé Studio</title>

    <link rel="stylesheet" href="./Acadé Studio_files/default.min.css">
    <link rel="stylesheet" href="./Acadé Studio_files/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <link rel="stylesheet" href="./Acadé Studio_files/codemirror.css">
    <link rel="stylesheet" href="./Acadé Studio_files/monokai.css">
    <link rel="stylesheet" href="./Acadé Studio_files/v3.css">

    <script src="./Acadé Studio_files/near-api-js.js.download"></script><script bis_use="true" type="text/javascript" charset="utf-8" data-bis-config="[&quot;facebook.com/&quot;,&quot;twitter.com/&quot;,&quot;youtube-nocookie.com/embed/&quot;,&quot;//vk.com/&quot;,&quot;//www.vk.com/&quot;,&quot;linkedin.com/&quot;,&quot;//www.linkedin.com/&quot;,&quot;//instagram.com/&quot;,&quot;//www.instagram.com/&quot;,&quot;//www.google.com/recaptcha/api2/&quot;,&quot;//hangouts.google.com/webchat/&quot;,&quot;//www.google.com/calendar/&quot;,&quot;//www.google.com/maps/embed&quot;,&quot;spotify.com/&quot;,&quot;soundcloud.com/&quot;,&quot;//player.vimeo.com/&quot;,&quot;//disqus.com/&quot;,&quot;//tgwidget.com/&quot;,&quot;//js.driftt.com/&quot;,&quot;friends2follow.com&quot;,&quot;/widget&quot;,&quot;login&quot;,&quot;//video.bigmir.net/&quot;,&quot;blogger.com&quot;,&quot;//smartlock.google.com/&quot;,&quot;//keep.google.com/&quot;,&quot;/web.tolstoycomments.com/&quot;,&quot;moz-extension://&quot;,&quot;chrome-extension://&quot;,&quot;/auth/&quot;,&quot;//analytics.google.com/&quot;,&quot;adclarity.com&quot;,&quot;paddle.com/checkout&quot;,&quot;hcaptcha.com&quot;,&quot;recaptcha.net&quot;,&quot;2captcha.com&quot;,&quot;accounts.google.com&quot;,&quot;www.google.com/shopping/customerreviews&quot;,&quot;buy.tinypass.com&quot;,&quot;gstatic.com&quot;,&quot;secureir.ebaystatic.com&quot;,&quot;docs.google.com&quot;,&quot;contacts.google.com&quot;,&quot;github.com&quot;,&quot;mail.google.com&quot;,&quot;chat.google.com&quot;,&quot;audio.xpleer.com&quot;,&quot;keepa.com&quot;,&quot;static.xx.fbcdn.net&quot;,&quot;sas.selleramp.com&quot;,&quot;1plus1.video&quot;,&quot;console.googletagservices.com&quot;,&quot;//lnkd.demdex.net/&quot;,&quot;//radar.cedexis.com/&quot;,&quot;//li.protechts.net/&quot;,&quot;challenges.cloudflare.com/&quot;,&quot;ogs.google.com&quot;]" src="chrome-extension://eppiocemhmnlbhjplcgkofciiegomcon/executers/vi-tr.js"></script>
    <script src="./Acadé Studio_files/katex.min.js.download" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script src="./Acadé Studio_files/highlight.min.js.download"></script>
    <script src="./Acadé Studio_files/cpp.min.js.download"></script>
    <script src="./Acadé Studio_files/codemirror.js.download"></script>
    <script src="./Acadé Studio_files/clike.js.download"></script>
    <script src="./Acadé Studio_files/simplescript.js.download"></script>
    <script src="./Acadé Studio_files/v3.js.download"></script>
    <script src="./Acadé Studio_files/v3task.js.download"></script>
    <script src="./Acadé Studio_files/simplescript(1).js.download"></script>
</head>
<body bis_register="W3sibWFzdGVyIjp0cnVlLCJleHRlbnNpb25JZCI6ImVwcGlvY2VtaG1ubGJoanBsY2drb2ZjaWllZ29tY29uIiwiYWRibG9ja2VyU3RhdHVzIjp7IkRJU1BMQVkiOiJkaXNhYmxlZCIsIkZBQ0VCT09LIjoiZGlzYWJsZWQiLCJUV0lUVEVSIjoiZGlzYWJsZWQiLCJSRURESVQiOiJkaXNhYmxlZCIsIlBJTlRFUkVTVCI6ImRpc2FibGVkIiwiSU5TVEFHUkFNIjoiZGlzYWJsZWQiLCJMSU5LRURJTiI6ImRpc2FibGVkIiwiQ09ORklHIjoiZGlzYWJsZWQifSwidmVyc2lvbiI6IjIuMC4xNiIsInNjb3JlIjoyMDAxNn1d" __processed_2e9c58ec-1ccb-49ff-80df-eede5c9dcd54__="true"><span></span><b><span>wprota.near</span></b><span>; L23; Balance: </span><span><span></span><b><span>Ⓝ 12.454</span></b><span></span></span><span><span>; Overhead: </span><b><span>Ⓝ 0.00</span></b><span>/</span><b><span>Ⓝ 0.00</span></b><span></span></span><span><span> :: Tasks: </span><b><span>0</span></b><span> pending; </span><b><span>0</span></b><span> rejected; </span><b><span>0</span></b><span> challenging </span></span><span> :: </span><span class="btnlink">Withdraw</span><span> :: </span><span class="btnlink">Overhead Logs</span><span> :: </span><span class="btnlink">Reports</span><span> :: </span><span class="btnlink">Docs</span><span> :: </span><span class="btnlink">Logout</span><br><span></span><br><div bis_skin_checked="1"><small><span style="padding-right: 10px;">03:57:53</span></small><b style="padding-right: 10px;">Ⓝ 1.241</b><div bis_skin_checked="1" style="display: none;"><br><b>Reason:</b><span></span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px; height: 200px;"><textarea style="position: absolute; margin: 0px; left: 0px; top: 0px; box-sizing: border-box; width: 0px; height: 200px;"></textarea><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px; position: absolute; top: 0px; width: 622px; left: 10px;"><span></span></div></div><br></div><button style="margin-right: 10px; background-color: rgb(240, 255, 240);">Challenger is Correct</button><button style="background-color: rgb(255, 208, 221);">Reviewer is Correct</button><small style="color: darkred;"><span><span><br>This work has been reviewed. Click </span></span><span class="btnlink">here</span><span><span> to see the reviews</span></span></small><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 5px;"><span class="btnlink">Close</span><span><br>1. </span><sup class="btnlink hidden-unless-ctrl-alt">[report]</sup><span style="color: darkred;"><b>Rejected this version.</b> </span><span><span>Ответ на 1-й семпл отличается и это не объяснено</span></span></div><small style="color: dodgerblue;"><span><span><br>The review is challenged. Click </span></span><span class="btnlink">here</span><span><span> to see the challenge reason</span></span></small><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 5px;"><span class="btnlink">Close</span><span><span><br>В блоке 15 я указал, что красота матрицы не измениться и это очевидно просто взглянув на сам тест (не описывать же мне каждый прямоугольник в матрице, это нерационально, их слишком много). Плюсом: https://t.me/AcadeStudioCF/48204</span></span></div><span><span><br></span></span><small><span class="btnlink">Report...</span></small><div bis_skin_checked="1" style="display: none;"></div><span><span><br><br></span></span><span><span>Please transcribe and solve problem </span><b><span>102439:B</span></b><span> from </span><b><span>gym</span></b><span>. Problem statement is here: </span></span><a target="_blank" href="https://codeforces.com/gym/102439/problem/B">https://codeforces.com/gym/102439/problem/B</a><span><span><br><br></span><b><span>Problem Statement:</span></b><span></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Варвара и матрица<br></span><b><span>ограничение по времени на тест:</span></b><span> 1 секунда<br></span><b><span>ограничение по памяти на тест:</span></b><span> 256 мегабайт<br>Варваре подарили матрицу </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span> состоящую из чисел от 0 до </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span><span>. В каждой строке и столбце данной матрицы встречается не больше одного 0.<br><br>Определим красотой матрицы количество различных прямоугольников этой матрицы, на четырех углах которых стоят одинаковые числа. Более формально красота матрицы — это количество различных наборов </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{x_1, x_2, y_1, y_2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span><span>, где «</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><msub><mi>x</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1 \le x_1 &lt; x_2 \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6891em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.786em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span>», «</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><msub><mi>y</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>y</mi><mn>2</mn></msub><mo>≤</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">1 \le y_1 &lt; y_2 \le m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7335em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0359em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>» и «</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub></mrow></msub></mrow><annotation encoding="application/x-tex">a_{x_1,y_1}=a_{x_1,y_2}=a_{x_2,y_1}=a_{x_2,y_2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span>».<br><br>Варваре стало любопытно, сможет ли она заменить каждый 0 в матрице на числа </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>, чтобы красота матрицы не изменилась. Обратите внимание, что каждый 0 заменяется независимо.<br><br></span><b><span>Входные данные</span></b><span><br>Первая строка содержит два целых числа </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span> и </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span> — количество строк и столбцов матрицы соответственно. Вторая строка содержит целое число </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span><span>. Третья строка содержит два целых числа </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> и </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> — числа, на которые возможно заменить 0 в матрице. Следующие </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span> строк содержат по </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span> целых чисел разделенных пробелом </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7167em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span> — описание данной матрицы.<br><br></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>≤</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo>≤</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">2 \le n,m \le 10^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8141em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span><span><br></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mi>n</mi><mo>⋅</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">2 \le k \le n \cdot m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">2</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8304em; vertical-align: -0.136em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.4445em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span><br></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>A</mi><mo separator="true">,</mo><mi>B</mi><mo>≤</mo><mi>k</mi><mo separator="true">,</mo><mi>A</mi><mo mathvariant="normal">≠</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">1 \le A,B \le k,A \neq B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span><br></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><msub><mi>a</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>≤</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">0 \le a_{i,j} \le k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7804em; vertical-align: -0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.9221em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span></span></span></span></span><span><br><br></span><b><span>Выходные данные</span></b><span><br>Выведите «Yes» и на следующих </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span> строках описание матрицы после замены всех 0, если соблюсти неизменность красоты возможно. Иначе в единственной строке выведите «No».</span></div></div><span><span><br><br></span><b><span>Sample Tests:</span></b><span></span></span><span><table><tbody><tr><td></td><td align="center"><span></span><b><span>Input</span></b><span></span></td><td align="center"><span></span><b><span>Output</span></b><span></span></td></tr><tr><td valign="middle"><span></span><b><span>1: </span></b><span></span></td><td><textarea rows="10" cols="50" readonly=""></textarea></td><td><textarea rows="10" cols="50" readonly=""></textarea></td></tr><tr><td valign="middle"><span></span><b><span>2: </span></b><span></span></td><td><textarea rows="10" cols="50" readonly=""></textarea></td><td><textarea rows="10" cols="50" readonly=""></textarea></td></tr></tbody></table></span><span><span><br><br><br></span><b><span>Step-by-step Solution</span></b></span><div bis_skin_checked="1" style="margin-bottom: 500px;"><span><span><br></span></span><sup class="btnlink">[1]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Давайте для начала представим задачу в виде графа. Так как в каждой строке и столбце встречается не более одного нуля, то это означает, что для любого прямоугольника нули на его углах могут располагаться только следующим образом:<br>1. Прямоугольник имеет только два нуля на углах, не лежащих в одной строке и столбце.<br>2. Прямоугольник имеет только один ноль на некотором углу.<br><br>Если прямоугольник уже содержит два различных числа на углах, то понятно, что он никак не повлияет на красоту матрицы. Если же числа одинаковые, но не равняются ни </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> ни </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>, то он тоже не повлияет на красоту, так как после замены нулей его углы станут различными. Если же числа одинаковые и равны </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span>, то в этом случае нельзя заменить одновременно все нули на углах на число </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span>, аналогично и с </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>. Пронумеруем ячейки содержащие нули и соединим пару нулей ребром со значением </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>, если они одновременно не могут быть заменены на значения </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> и </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> соответственно (в случае единственного нуля на углу, у нас будет петля, означающая, что мы не сможем заменить ноль на одно из значений </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>).<br><br>Проверять пары нулей можно за </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\min(n, m)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0641em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>, а вот для случая одного нуля нужно быстро проверять есть ли прямоугольник, содержащий в качестве остальных значений на углах </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>. Это можно сделать за </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\min(n, m) \cdot nm)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0278em;">O</span><span class="mopen">(</span><span class="mop">min</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">nm</span><span class="mclose">)</span></span></span></span></span><span> перебирая сначала ноль (соответствует некоторому углу прямоугольника) а затем позицию противоположного угла. Чтобы оптимизировать алгоритм будем использовать </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi><mi>e</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">bitset</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal">bi</span><span class="mord mathnormal">t</span><span class="mord mathnormal">se</span><span class="mord mathnormal">t</span></span></span></span></span><span>. Пусть рассматриваемый ноль находится в ячейке с координатами </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span><span class="mclose">)</span></span></span></span></span><span>, тогда переберем позицию угла, который лежит в том же столбце (со значением </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> для разных случаев) и сделаем операцию побитового "или" по всем битсетам для соответствующих строк (посчитаем отдельно два битсета для </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> и </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> для каждой строки матрицы, содержащих единицу в соответствующей позиции, если элемент матрицы равен </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>). Если результирующий битсет совпадает хотя бы в одной единичной позиции с битсетом строки </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>, то, очевидно, мы нашли прямоугольник и должны провести ребро-петлю.</span></div></div></span><span><span><br></span></span><sup class="btnlink">[2]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Приступим к реализации. Посчитаем битсеты для </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> и </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> и напишем функцию по поиску прямоугольника с тремя </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> на углах для рассматриваемого нуля.</span></div></div></span><span><span><br></span></span><sup class="btnlink">[3]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box;"><pre class="cpp hljs"><div bis_skin_checked="1"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1"><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;
</div><div bis_skin_checked="1"><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt; <span class="hljs-keyword">using</span> ve = vector&lt;T&gt;;
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">cell</span> {</span>
</div><div bis_skin_checked="1">    <span class="hljs-keyword">int</span> x, y;
</div><div bis_skin_checked="1">    <span class="hljs-built_in">cell</span>(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y) : <span class="hljs-built_in">x</span>(x), <span class="hljs-built_in">y</span>(y) {}
</div><div bis_skin_checked="1">};
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
</div><div bis_skin_checked="1">    ios_base::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>);
</div><div bis_skin_checked="1">    cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">int</span> n, m, k, A, B;
</div><div bis_skin_checked="1">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k &gt;&gt; A &gt;&gt; B;
</div><div bis_skin_checked="1">    ve&lt;ve&lt;<span class="hljs-keyword">int</span>&gt;&gt; <span class="hljs-built_in">a</span>(n, ve&lt;<span class="hljs-keyword">int</span>&gt;(m));
</div><div bis_skin_checked="1">    ve&lt;cell&gt; zc;
</div><div bis_skin_checked="1">    ve&lt;bitset&lt;1000&gt;&gt; <span class="hljs-built_in">Ac</span>(n), <span class="hljs-built_in">Bc</span>(n);
</div><div bis_skin_checked="1">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
</div><div bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j++) {
</div><div bis_skin_checked="1">            cin &gt;&gt; a[i][j];
</div><div bis_skin_checked="1">            <span class="hljs-keyword">if</span> (a[i][j] == <span class="hljs-number">0</span>) zc.<span class="hljs-built_in">emplace_back</span>(i, j);
</div><div bis_skin_checked="1">            <span class="hljs-keyword">if</span> (a[i][j] == A) Ac[i].<span class="hljs-built_in">set</span>(j);
</div><div bis_skin_checked="1">            <span class="hljs-keyword">if</span> (a[i][j] == B) Bc[i].<span class="hljs-built_in">set</span>(j);
</div><div bis_skin_checked="1">        }
</div><div bis_skin_checked="1">    }
</div><div bis_skin_checked="1">    <span class="hljs-keyword">auto</span> cft = [&amp;](<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> type, ve&lt;bitset&lt;<span class="hljs-number">1000</span>&gt;&gt; &amp;typec) {
</div><div bis_skin_checked="1">        bitset&lt;<span class="hljs-number">1000</span>&gt; res;
</div><div bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
</div><div bis_skin_checked="1">            <span class="hljs-keyword">if</span> (i != x &amp;&amp; a[i][y] == type) res |= typec[i];
</div><div bis_skin_checked="1">        }
</div><div bis_skin_checked="1">        <span class="hljs-keyword">return</span> (typec[x] &amp; res).<span class="hljs-built_in">any</span>();
</div><div bis_skin_checked="1">    };
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div bis_skin_checked="1">}
</div></pre></div></div></span><span><span><br></span></span><sup class="btnlink">[4]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Теперь проведем ребра. Одновременно переберем пары нулей и отдельный ноль (во втором случае используем написанную нами функцию для поиска прямоугольников), заполняем матрицу смежности. Если у вершины есть две петли с разными значениями, то какое бы значение (</span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>) мы не поставили, красота матрицы измениться, значит сразу можем вывести "No".</span></div></div></span><span><span><br></span></span><sup class="btnlink">[5]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box;"><pre class="cpp hljs"><div bis_skin_checked="1">...
</div><div bis_skin_checked="1">        }
</div><div bis_skin_checked="1">        <span class="hljs-keyword">return</span> (typec[x] &amp; res).<span class="hljs-built_in">any</span>();
</div><div bis_skin_checked="1">    };
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    ve&lt;ve&lt;<span class="hljs-keyword">int</span>&gt;&gt; <span class="hljs-built_in">e</span>(zc.<span class="hljs-built_in">size</span>(), ve&lt;<span class="hljs-keyword">int</span>&gt;(zc.<span class="hljs-built_in">size</span>()));
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; zc.<span class="hljs-built_in">size</span>(); i++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> j = <span class="hljs-number">0</span>; j &lt; zc.<span class="hljs-built_in">size</span>(); j++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">if</span> (i == j) <span class="hljs-keyword">continue</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">if</span> (a[zc[i].x][zc[j].y] == a[zc[j].x][zc[i].y]) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                <span class="hljs-keyword">if</span> (a[zc[i].x][zc[j].y] == A) e[i][j] = A;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                <span class="hljs-keyword">if</span> (a[zc[i].x][zc[j].y] == B) e[i][j] = B;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">bool</span> f = <span class="hljs-built_in">cft</span>(zc[i].x, zc[i].y, A, Ac);
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">bool</span> s = <span class="hljs-built_in">cft</span>(zc[i].x, zc[i].y, B, Bc);
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (f &amp;&amp; s) <span class="hljs-keyword">return</span> cout &lt;&lt; <span class="hljs-string">"No\n"</span>, <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (f) e[i][i] = A;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (s) e[i][i] = B;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    }
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div bis_skin_checked="1">}
</div></pre></div></div></span><span><span><br></span></span><sup class="btnlink">[6]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Теперь у нас есть граф и нужно пометить вершины значениями </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> или </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span>, чтобы значение любого ребра не было равно значениям одновременно двух вершин, которое оно соединяет (назовем такое ребро "хорошим").<br>Давайте проходится по вершинам и пытаться жадно поставить значение для нее. Пусть сначала пробуем </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span>. Теперь можно запустить рекурсию из этой вершины и действовать следующим образом (обозначим </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> за 0, а </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> за 1 для удобства): если в текущей вершине значение </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span></span></span></span></span><span> (0 или 1), то перейдем по ребрам с таким же значением и запустим рекурсию от вершин в которые перешли (очевидно, что для них значение будет строго </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">1 - val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6944em;"></span><span class="mord mathnormal" style="margin-right: 0.0359em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right: 0.0197em;">l</span></span></span></span></span><span>, так как в противном случае на концах ребра находились бы равные ребру зничения, а мы пытаемся этого избежать, чтобы красота матрицы не поменялась). Продолжим процесс, пока не сможем запуститься ни от одной вершины. Это означает, что все ребра, ведущие из множества рассмотренных рекурсией вершин в множество нерассмотренных, имеют значение, отличное от рассмотренных вершин на одном из их концов, т. е. для нерассмотренных вершин на другом конце ребра можем определить любое из значений 1 или 0 и ребро будет "хорошим" в любом случае. Получается можно просто удалить рассмотренное множество вершин, так как значения для них посчитаны и они не влияют на значения нерассмотренных вершин, и продолжить работать уже с нерассмотренными вершинами. Если же в результате запуска рекурсии получилось так, что какое-то из ребер оказалось не "хорошим", то значение </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> для стартовой вершины не подходит, т. е. вынуждены пробовать значение </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> аналогичным способом. Если же и для </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> тоже нашлось не "хорошее" ребро, то оба из значений </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> меняют красоту матрицы, т. е. ответ "No".</span></div></div></span><span><span><br></span></span><sup class="btnlink">[7]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Напишем вышеописанную рекурсивную функцию, она расставит значения для вершин и вернет false или true в зависимости от того, получились ли не "хорошие" ребра или нет соответственно. Заполним также некоторый вектор вершинами, которые прошла рекурсия, чтобы очистить значения вершин, если вынуждены провести второй запуск, но со значением </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> стартовой вершины или удалить их из графа, если первый запуск удался.</span></div></div></span><span><span><br></span></span><sup class="btnlink">[8]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box;"><pre class="cpp hljs"><div bis_skin_checked="1">...
</div><div bis_skin_checked="1">        <span class="hljs-keyword">if</span> (f) e[i][i] = A;
</div><div bis_skin_checked="1">        <span class="hljs-keyword">if</span> (s) e[i][i] = B;
</div><div bis_skin_checked="1">    }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-function">ve&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">type</span><span class="hljs-params">(zc.size())</span></span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    ve&lt;<span class="hljs-keyword">int</span>&gt; wt;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    function&lt;<span class="hljs-built_in"><span class="hljs-keyword">bool</span></span>(<span class="hljs-keyword">int</span>)&gt; dfs = [&amp;](<span class="hljs-keyword">int</span> v) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; zc.<span class="hljs-built_in">size</span>(); i++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">if</span> (!type[i] &amp;&amp; e[v][i] == type[v]) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                type[i] = (type[v] == A ? B : A);
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                wt.<span class="hljs-built_in">push_back</span>(i);
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">dfs</span>(i)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">if</span> (type[i] &amp;&amp; type[i] == e[v][i] &amp;&amp; type[i] == type[v]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    };
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div bis_skin_checked="1">}
</div></pre></div></div></span><span><span><br></span></span><sup class="btnlink">[9]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Напишем функцию удаления вершин из графа (просто удаляем их ребра в матрице смежности).</span></div></div></span><span><span><br></span></span><sup class="btnlink">[10]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box;"><pre class="cpp hljs"><div bis_skin_checked="1">...
</div><div bis_skin_checked="1">        }
</div><div bis_skin_checked="1">        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
</div><div bis_skin_checked="1">    };
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-keyword">auto</span> del = [&amp;]() {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; wt.<span class="hljs-built_in">size</span>(); i++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> j = <span class="hljs-number">0</span>; j &lt; zc.<span class="hljs-built_in">size</span>(); j++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">                e[wt[i]][j] = e[j][wt[i]] = <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    };
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div bis_skin_checked="1">}
</div></pre></div></div></span><span><span><br></span></span><sup class="btnlink">[11]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>Перебираем вершину, пробуем первый запуск со значением </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span>, если он удался, то удаляем рассмотренные вершины из графа, иначе чистим значения вершин и пробуем второй запуск со значением </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> и так же удаляем вершины в случае успеха. Если ни </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></span><span> ни </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span></span></span></span></span><span> не подошло, то ответ "No".<br><br>После всех итераций, если сумели расставить значения для каждого нуля, то выводим полученные значения.</span></div></div></span><span><span><br></span></span><sup class="btnlink">[12]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box;"><pre class="cpp hljs"><div bis_skin_checked="1">...
</div><div bis_skin_checked="1">            }
</div><div bis_skin_checked="1">        }
</div><div bis_skin_checked="1">    };
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; zc.<span class="hljs-built_in">size</span>(); i++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (type[i]) <span class="hljs-keyword">continue</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        wt.<span class="hljs-built_in">clear</span>();
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        type[i] = A;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">dfs</span>(i)) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-built_in">del</span>();
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">continue</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">while</span> (!wt.<span class="hljs-built_in">empty</span>()) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            type[wt.<span class="hljs-built_in">back</span>()] = <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            wt.<span class="hljs-built_in">pop_back</span>();
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        type[i] = B;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">dfs</span>(i)) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-built_in">del</span>();
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            <span class="hljs-keyword">continue</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">return</span> cout &lt;&lt; <span class="hljs-string">"No\n"</span>, <span class="hljs-number">0</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    cout &lt;&lt; <span class="hljs-string">"Yes\n"</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; zc.<span class="hljs-built_in">size</span>(); i++) a[zc[i].x][zc[i].y] = type[i];
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j++) {
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">            cout &lt;&lt; a[i][j] &lt;&lt; <span class="hljs-string">' '</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        }
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">        cout &lt;&lt; <span class="hljs-string">'\n'</span>;
</div><div style="background-color: rgb(208, 255, 208);" bis_skin_checked="1">    }
</div><div bis_skin_checked="1">
</div><div bis_skin_checked="1">    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</div><div bis_skin_checked="1">}
</div></pre></div></div></span><span><span><br></span></span><sup class="btnlink">[13]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span></span><b><span>Input:</span></b><span><br></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">4 4<br>5<br>3 5<br>1 1 0 3<br>0 5 4 5<br>1 1 4 4<br>2 5 3 0<br></div><span><span><br></span><b><span>Output:</span></b><span><br></span></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">Yes<br>1 1 5 3 <br>3 5 4 5 <br>1 1 4 4 <br>2 5 3 3 <br></div></div></div></span><span><span><br></span></span><sup class="btnlink">[14]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span></span><b><span>Input:</span></b><span><br></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">4 4<br>4<br>1 2<br>1 1 3 3<br>1 0 2 3<br>1 2 0 3<br>1 3 1 3<br></div><span><span><br></span><b><span>Output:</span></b><span><br></span></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">No<br></div></div></div></span><span><span><br></span></span><sup class="btnlink">[15]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span>В первом тесте ответ отличается (в клетке </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span><span> значение 3 вместо 5), но несложно видеть, что такой вариант так же не меняет красоту матрицы.<br><br>Проверим решение на тесте:<br></span><div bis_skin_checked="1" style="white-space: pre; font-family: monospace; border: 1px solid gray; border-radius: 5px; padding: 5px; background-color: rgb(240, 240, 240);"><span>3 3 <br>2 <br>1 2<br>1 1 1<br>1 2 2<br>1 2 0<br></span></div><span>Здесь видно, что какое бы мы значение (1 или 2) не поставили вместо нуля добавится один прямоугольник с равными значениями на углах, поэтому ожидаем "No" в качестве ответа.</span></div></div></span><span><span><br></span></span><sup class="btnlink">[16]</sup><span><span><span><br></span></span><div bis_skin_checked="1" style="position: relative; left: 0px; top: 0px;"><div bis_skin_checked="1" style="box-sizing: border-box; padding: 5px;"><span></span><b><span>Input:</span></b><span><br></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">3 3 <br>2 <br>1 2<br>1 1 1<br>1 2 2<br>1 2 0</div><span><span><br></span><b><span>Output:</span></b><span><br></span></span><div bis_skin_checked="1" style="border: 1px solid black; border-radius: 5px; padding: 10px; margin: 15px; font-family: monospace; white-space: pre-wrap;">No<br></div></div></div></span><span><span><br></span></span><sup class="btnlink">[17]</sup><span><span><span><br></span></span><span><span>Submitted to the Online Judge.<br>Execution result: </span><b><span>Accepted</span></b><span></span><span><span><br></span></span></span></span><span><span><br></span></span><sup class="btnlink">[18]</sup><span><span><br></span></span></div></div></body></html>